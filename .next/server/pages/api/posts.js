"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/posts";
exports.ids = ["pages/api/posts"];
exports.modules = {

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mongodb");

/***/ }),

/***/ "next-auth/next":
/*!*********************************!*\
  !*** external "next-auth/next" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("next-auth/next");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "pusher":
/*!*************************!*\
  !*** external "pusher" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("pusher");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fposts&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cposts%5Cindex.js&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fposts&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cposts%5Cindex.js&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_posts_index_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\posts\\index.js */ \"(api)/./pages/api/posts/index.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_posts_index_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_posts_index_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/posts\",\n        pathname: \"/api/posts\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_posts_index_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnBvc3RzJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUNwb3N0cyU1Q2luZGV4LmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzBEO0FBQzFEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxzREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsc0RBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veC1jbG9uZS1uZXh0anMvPzZjNWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFxwb3N0c1xcXFxpbmRleC5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3Bvc3RzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvcG9zdHNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fposts&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cposts%5Cindex.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/mongodb.js":
/*!************************!*\
  !*** ./lib/mongodb.js ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_0__);\n\nif (!process.env.MONGODB_URI) {\n    const error = new Error(\"Please add your Mongo URI to .env.local\");\n    console.error(\"MongoDB 連接錯誤:\", error.message);\n    throw error;\n}\nconst uri = process.env.MONGODB_URI;\nconst options = {};\nlet client;\nlet clientPromise;\nif (true) {\n    // 開發環境：使用全局變量避免多次連接\n    if (!global._mongoClientPromise) {\n        client = new mongodb__WEBPACK_IMPORTED_MODULE_0__.MongoClient(uri, options);\n        global._mongoClientPromise = client.connect().catch((error)=>{\n            console.error(\"MongoDB 連接失敗:\", error.message);\n            throw error;\n        });\n    }\n    clientPromise = global._mongoClientPromise;\n} else {}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (clientPromise);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvbW9uZ29kYi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBc0M7QUFFdEMsSUFBSSxDQUFDQyxRQUFRQyxHQUFHLENBQUNDLFdBQVcsRUFBRTtJQUM1QixNQUFNQyxRQUFRLElBQUlDLE1BQU07SUFDeEJDLFFBQVFGLEtBQUssQ0FBQyxpQkFBaUJBLE1BQU1HLE9BQU87SUFDNUMsTUFBTUg7QUFDUjtBQUVBLE1BQU1JLE1BQU1QLFFBQVFDLEdBQUcsQ0FBQ0MsV0FBVztBQUNuQyxNQUFNTSxVQUFVLENBQUM7QUFFakIsSUFBSUM7QUFDSixJQUFJQztBQUVKLElBQUlWLElBQXlCLEVBQWU7SUFDMUMsb0JBQW9CO0lBQ3BCLElBQUksQ0FBQ1csT0FBT0MsbUJBQW1CLEVBQUU7UUFDL0JILFNBQVMsSUFBSVYsZ0RBQVdBLENBQUNRLEtBQUtDO1FBQzlCRyxPQUFPQyxtQkFBbUIsR0FBR0gsT0FBT0ksT0FBTyxHQUFHQyxLQUFLLENBQUMsQ0FBQ1g7WUFDbkRFLFFBQVFGLEtBQUssQ0FBQyxpQkFBaUJBLE1BQU1HLE9BQU87WUFDNUMsTUFBTUg7UUFDUjtJQUNGO0lBQ0FPLGdCQUFnQkMsT0FBT0MsbUJBQW1CO0FBQzVDLE9BQU8sRUFPTjtBQUVELGlFQUFlRixhQUFhQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veC1jbG9uZS1uZXh0anMvLi9saWIvbW9uZ29kYi5qcz9kOTIwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE1vbmdvQ2xpZW50IH0gZnJvbSAnbW9uZ29kYic7XHJcblxyXG5pZiAoIXByb2Nlc3MuZW52Lk1PTkdPREJfVVJJKSB7XHJcbiAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ1BsZWFzZSBhZGQgeW91ciBNb25nbyBVUkkgdG8gLmVudi5sb2NhbCcpO1xyXG4gIGNvbnNvbGUuZXJyb3IoJ01vbmdvREIg6YCj5o6l6Yyv6KqkOicsIGVycm9yLm1lc3NhZ2UpO1xyXG4gIHRocm93IGVycm9yO1xyXG59XHJcblxyXG5jb25zdCB1cmkgPSBwcm9jZXNzLmVudi5NT05HT0RCX1VSSTtcclxuY29uc3Qgb3B0aW9ucyA9IHt9O1xyXG5cclxubGV0IGNsaWVudDtcclxubGV0IGNsaWVudFByb21pc2U7XHJcblxyXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcclxuICAvLyDplovnmbznkrDlooPvvJrkvb/nlKjlhajlsYDororph4/pgb/lhY3lpJrmrKHpgKPmjqVcclxuICBpZiAoIWdsb2JhbC5fbW9uZ29DbGllbnRQcm9taXNlKSB7XHJcbiAgICBjbGllbnQgPSBuZXcgTW9uZ29DbGllbnQodXJpLCBvcHRpb25zKTtcclxuICAgIGdsb2JhbC5fbW9uZ29DbGllbnRQcm9taXNlID0gY2xpZW50LmNvbm5lY3QoKS5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcignTW9uZ29EQiDpgKPmjqXlpLHmlZc6JywgZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGNsaWVudFByb21pc2UgPSBnbG9iYWwuX21vbmdvQ2xpZW50UHJvbWlzZTtcclxufSBlbHNlIHtcclxuICAvLyDnlJ/nlKLnkrDlooNcclxuICBjbGllbnQgPSBuZXcgTW9uZ29DbGllbnQodXJpLCBvcHRpb25zKTtcclxuICBjbGllbnRQcm9taXNlID0gY2xpZW50LmNvbm5lY3QoKS5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ01vbmdvREIg6YCj5o6l5aSx5pWXOicsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsaWVudFByb21pc2U7XHJcblxyXG4iXSwibmFtZXMiOlsiTW9uZ29DbGllbnQiLCJwcm9jZXNzIiwiZW52IiwiTU9OR09EQl9VUkkiLCJlcnJvciIsIkVycm9yIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJ1cmkiLCJvcHRpb25zIiwiY2xpZW50IiwiY2xpZW50UHJvbWlzZSIsImdsb2JhbCIsIl9tb25nb0NsaWVudFByb21pc2UiLCJjb25uZWN0IiwiY2F0Y2giXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/mongodb.js\n");

/***/ }),

/***/ "(api)/./lib/pusher.js":
/*!***********************!*\
  !*** ./lib/pusher.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   pusherServer: () => (/* binding */ pusherServer)\n/* harmony export */ });\n/* harmony import */ var pusher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pusher */ \"pusher\");\n/* harmony import */ var pusher__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pusher__WEBPACK_IMPORTED_MODULE_0__);\n\n// 檢查 Pusher 環境變量是否設置，並且不是占位符值\nconst isPlaceholder = (value)=>{\n    if (!value) return true;\n    const placeholderPatterns = [\n        /^your-/i,\n        /^placeholder/i,\n        /^example/i,\n        /^test-/i,\n        /^xxx/i\n    ];\n    return placeholderPatterns.some((pattern)=>pattern.test(value));\n};\nconst hasPusherConfig = process.env.PUSHER_APP_ID && process.env.PUSHER_KEY && process.env.PUSHER_SECRET && !isPlaceholder(process.env.PUSHER_APP_ID) && !isPlaceholder(process.env.PUSHER_KEY) && !isPlaceholder(process.env.PUSHER_SECRET);\n// 只有在配置了 Pusher 時才創建實例\nlet pusherServer = null;\nif (hasPusherConfig) {\n    try {\n        const cluster = process.env.PUSHER_CLUSTER || \"us2\";\n        // 檢查 cluster 是否為占位符\n        if (!isPlaceholder(cluster)) {\n            pusherServer = new (pusher__WEBPACK_IMPORTED_MODULE_0___default())({\n                appId: process.env.PUSHER_APP_ID,\n                key: process.env.PUSHER_KEY,\n                secret: process.env.PUSHER_SECRET,\n                cluster: cluster,\n                useTLS: true\n            });\n            console.log(\"Pusher 初始化成功\");\n        } else {\n            console.warn(\"Pusher cluster 是占位符值，跳過初始化\");\n        }\n    } catch (error) {\n        // 如果 Pusher 初始化失敗，記錄錯誤但不報錯\n        console.error(\"Pusher 初始化失敗:\", error.message);\n        pusherServer = null;\n    }\n} else {\n    // 如果沒有配置 Pusher，記錄警告\n    if (true) {\n        console.warn(\"Pusher 未配置或包含占位符值，實時功能將不可用。請在 .env.local 中設置有效的 PUSHER_APP_ID, PUSHER_KEY, PUSHER_SECRET\");\n    }\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvcHVzaGVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE0QjtBQUU1Qiw4QkFBOEI7QUFDOUIsTUFBTUMsZ0JBQWdCLENBQUNDO0lBQ3JCLElBQUksQ0FBQ0EsT0FBTyxPQUFPO0lBQ25CLE1BQU1DLHNCQUFzQjtRQUMxQjtRQUNBO1FBQ0E7UUFDQTtRQUNBO0tBQ0Q7SUFDRCxPQUFPQSxvQkFBb0JDLElBQUksQ0FBQ0MsQ0FBQUEsVUFBV0EsUUFBUUMsSUFBSSxDQUFDSjtBQUMxRDtBQUVBLE1BQU1LLGtCQUNKQyxRQUFRQyxHQUFHLENBQUNDLGFBQWEsSUFDekJGLFFBQVFDLEdBQUcsQ0FBQ0UsVUFBVSxJQUN0QkgsUUFBUUMsR0FBRyxDQUFDRyxhQUFhLElBQ3pCLENBQUNYLGNBQWNPLFFBQVFDLEdBQUcsQ0FBQ0MsYUFBYSxLQUN4QyxDQUFDVCxjQUFjTyxRQUFRQyxHQUFHLENBQUNFLFVBQVUsS0FDckMsQ0FBQ1YsY0FBY08sUUFBUUMsR0FBRyxDQUFDRyxhQUFhO0FBRTFDLHVCQUF1QjtBQUN2QixJQUFJQyxlQUFlO0FBRW5CLElBQUlOLGlCQUFpQjtJQUNuQixJQUFJO1FBQ0YsTUFBTU8sVUFBVU4sUUFBUUMsR0FBRyxDQUFDTSxjQUFjLElBQUk7UUFDOUMsb0JBQW9CO1FBQ3BCLElBQUksQ0FBQ2QsY0FBY2EsVUFBVTtZQUMzQkQsZUFBZSxJQUFJYiwrQ0FBTUEsQ0FBQztnQkFDeEJnQixPQUFPUixRQUFRQyxHQUFHLENBQUNDLGFBQWE7Z0JBQ2hDTyxLQUFLVCxRQUFRQyxHQUFHLENBQUNFLFVBQVU7Z0JBQzNCTyxRQUFRVixRQUFRQyxHQUFHLENBQUNHLGFBQWE7Z0JBQ2pDRSxTQUFTQTtnQkFDVEssUUFBUTtZQUNWO1lBQ0FDLFFBQVFDLEdBQUcsQ0FBQztRQUNkLE9BQU87WUFDTEQsUUFBUUUsSUFBSSxDQUFDO1FBQ2Y7SUFDRixFQUFFLE9BQU9DLE9BQU87UUFDZCwyQkFBMkI7UUFDM0JILFFBQVFHLEtBQUssQ0FBQyxpQkFBaUJBLE1BQU1DLE9BQU87UUFDNUNYLGVBQWU7SUFDakI7QUFDRixPQUFPO0lBQ0wscUJBQXFCO0lBQ3JCLElBQUlMLElBQXlCLEVBQWU7UUFDMUNZLFFBQVFFLElBQUksQ0FBQztJQUNmO0FBQ0Y7QUFFd0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly94LWNsb25lLW5leHRqcy8uL2xpYi9wdXNoZXIuanM/MGFkNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUHVzaGVyIGZyb20gJ3B1c2hlcic7XHJcblxyXG4vLyDmqqLmn6UgUHVzaGVyIOeSsOWig+iuiumHj+aYr+WQpuioree9ru+8jOS4puS4lOS4jeaYr+WNoOS9jeespuWAvFxyXG5jb25zdCBpc1BsYWNlaG9sZGVyID0gKHZhbHVlKSA9PiB7XHJcbiAgaWYgKCF2YWx1ZSkgcmV0dXJuIHRydWU7XHJcbiAgY29uc3QgcGxhY2Vob2xkZXJQYXR0ZXJucyA9IFtcclxuICAgIC9eeW91ci0vaSxcclxuICAgIC9ecGxhY2Vob2xkZXIvaSxcclxuICAgIC9eZXhhbXBsZS9pLFxyXG4gICAgL150ZXN0LS9pLFxyXG4gICAgL154eHgvaSxcclxuICBdO1xyXG4gIHJldHVybiBwbGFjZWhvbGRlclBhdHRlcm5zLnNvbWUocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QodmFsdWUpKTtcclxufTtcclxuXHJcbmNvbnN0IGhhc1B1c2hlckNvbmZpZyA9IFxyXG4gIHByb2Nlc3MuZW52LlBVU0hFUl9BUFBfSUQgJiZcclxuICBwcm9jZXNzLmVudi5QVVNIRVJfS0VZICYmXHJcbiAgcHJvY2Vzcy5lbnYuUFVTSEVSX1NFQ1JFVCAmJlxyXG4gICFpc1BsYWNlaG9sZGVyKHByb2Nlc3MuZW52LlBVU0hFUl9BUFBfSUQpICYmXHJcbiAgIWlzUGxhY2Vob2xkZXIocHJvY2Vzcy5lbnYuUFVTSEVSX0tFWSkgJiZcclxuICAhaXNQbGFjZWhvbGRlcihwcm9jZXNzLmVudi5QVVNIRVJfU0VDUkVUKTtcclxuXHJcbi8vIOWPquacieWcqOmFjee9ruS6hiBQdXNoZXIg5pmC5omN5Ym15bu65a+m5L6LXHJcbmxldCBwdXNoZXJTZXJ2ZXIgPSBudWxsO1xyXG5cclxuaWYgKGhhc1B1c2hlckNvbmZpZykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBjbHVzdGVyID0gcHJvY2Vzcy5lbnYuUFVTSEVSX0NMVVNURVIgfHwgJ3VzMic7XHJcbiAgICAvLyDmqqLmn6UgY2x1c3RlciDmmK/lkKbngrrljaDkvY3nrKZcclxuICAgIGlmICghaXNQbGFjZWhvbGRlcihjbHVzdGVyKSkge1xyXG4gICAgICBwdXNoZXJTZXJ2ZXIgPSBuZXcgUHVzaGVyKHtcclxuICAgICAgICBhcHBJZDogcHJvY2Vzcy5lbnYuUFVTSEVSX0FQUF9JRCxcclxuICAgICAgICBrZXk6IHByb2Nlc3MuZW52LlBVU0hFUl9LRVksXHJcbiAgICAgICAgc2VjcmV0OiBwcm9jZXNzLmVudi5QVVNIRVJfU0VDUkVULFxyXG4gICAgICAgIGNsdXN0ZXI6IGNsdXN0ZXIsXHJcbiAgICAgICAgdXNlVExTOiB0cnVlLFxyXG4gICAgICB9KTtcclxuICAgICAgY29uc29sZS5sb2coJ1B1c2hlciDliJ3lp4vljJbmiJDlip8nKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignUHVzaGVyIGNsdXN0ZXIg5piv5Y2g5L2N56ym5YC877yM6Lez6YGO5Yid5aeL5YyWJyk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIC8vIOWmguaenCBQdXNoZXIg5Yid5aeL5YyW5aSx5pWX77yM6KiY6YyE6Yyv6Kqk5L2G5LiN5aCx6YyvXHJcbiAgICBjb25zb2xlLmVycm9yKCdQdXNoZXIg5Yid5aeL5YyW5aSx5pWXOicsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgcHVzaGVyU2VydmVyID0gbnVsbDtcclxuICB9XHJcbn0gZWxzZSB7XHJcbiAgLy8g5aaC5p6c5rKS5pyJ6YWN572uIFB1c2hlcu+8jOiomOmMhOitpuWRilxyXG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50Jykge1xyXG4gICAgY29uc29sZS53YXJuKCdQdXNoZXIg5pyq6YWN572u5oiW5YyF5ZCr5Y2g5L2N56ym5YC877yM5a+m5pmC5Yqf6IO95bCH5LiN5Y+v55So44CC6KuL5ZyoIC5lbnYubG9jYWwg5Lit6Kit572u5pyJ5pWI55qEIFBVU0hFUl9BUFBfSUQsIFBVU0hFUl9LRVksIFBVU0hFUl9TRUNSRVQnKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IHB1c2hlclNlcnZlciB9O1xyXG5cclxuIl0sIm5hbWVzIjpbIlB1c2hlciIsImlzUGxhY2Vob2xkZXIiLCJ2YWx1ZSIsInBsYWNlaG9sZGVyUGF0dGVybnMiLCJzb21lIiwicGF0dGVybiIsInRlc3QiLCJoYXNQdXNoZXJDb25maWciLCJwcm9jZXNzIiwiZW52IiwiUFVTSEVSX0FQUF9JRCIsIlBVU0hFUl9LRVkiLCJQVVNIRVJfU0VDUkVUIiwicHVzaGVyU2VydmVyIiwiY2x1c3RlciIsIlBVU0hFUl9DTFVTVEVSIiwiYXBwSWQiLCJrZXkiLCJzZWNyZXQiLCJ1c2VUTFMiLCJjb25zb2xlIiwibG9nIiwid2FybiIsImVycm9yIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/pusher.js\n");

/***/ }),

/***/ "(api)/./pages/api/posts/index.js":
/*!**********************************!*\
  !*** ./pages/api/posts/index.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_auth_next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/next */ \"next-auth/next\");\n/* harmony import */ var next_auth_next__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth_next__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_mongodb__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/mongodb */ \"(api)/./lib/mongodb.js\");\n/* harmony import */ var _lib_pusher__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/pusher */ \"(api)/./lib/pusher.js\");\n\n\n\nasync function handler(req, res) {\n    if (req.method === \"GET\") {\n        try {\n            const session = await (0,next_auth_next__WEBPACK_IMPORTED_MODULE_0__.getServerSession)(req, res);\n            if (!session) {\n                return res.status(401).json({\n                    success: false,\n                    message: \"未登入\"\n                });\n            }\n            const { filter } = req.query; // 'all' or 'following'\n            const client = await _lib_mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n            const db = client.db();\n            const posts = db.collection(\"posts\");\n            const users = db.collection(\"users\");\n            let query = {};\n            // 如果是 following 模式，只获取 follow 的用户发布的文章\n            if (filter === \"following\") {\n                // 获取当前用户的 follow 列表\n                const currentUser = await users.findOne({\n                    $or: [\n                        {\n                            userID: session.user?.userID\n                        },\n                        {\n                            email: session.user?.email\n                        }\n                    ]\n                });\n                const followingList = currentUser?.following || [];\n                if (followingList.length === 0) {\n                    // 如果没有 follow 任何人，返回空列表\n                    return res.status(200).json({\n                        success: true,\n                        posts: []\n                    });\n                }\n                // 查询 follow 的用户发布的文章\n                query = {\n                    \"author.userID\": {\n                        $in: followingList\n                    }\n                };\n            }\n            const allPosts = await posts.find(query).sort({\n                createdAt: -1\n            }).limit(50).toArray();\n            return res.status(200).json({\n                success: true,\n                posts: allPosts.map((post)=>({\n                        id: post._id.toString(),\n                        content: post.content,\n                        author: post.author,\n                        likes: post.likes || [],\n                        comments: post.comments || [],\n                        repostCount: post.repostCount || 0,\n                        repost: post.repost || null,\n                        createdAt: post.createdAt\n                    }))\n            });\n        } catch (error) {\n            console.error(\"Get posts error:\", error);\n            return res.status(500).json({\n                success: false,\n                message: \"獲取貼文失敗\",\n                error:  true ? error.message : 0\n            });\n        }\n    } else if (req.method === \"POST\") {\n        try {\n            const session = await (0,next_auth_next__WEBPACK_IMPORTED_MODULE_0__.getServerSession)(req, res);\n            if (!session) {\n                return res.status(401).json({\n                    success: false,\n                    message: \"未登入\"\n                });\n            }\n            const { content } = req.body;\n            if (!content || content.trim() === \"\") {\n                return res.status(400).json({\n                    success: false,\n                    message: \"貼文內容不能為空\"\n                });\n            }\n            const client = await _lib_mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n            const db = client.db();\n            const posts = db.collection(\"posts\");\n            const users = db.collection(\"users\");\n            // 确保 userID 存在\n            let authorUserID = session.user?.userID;\n            // 调试日志\n            console.log(\"Creating post - session check:\", {\n                sessionUserID: session.user?.userID,\n                sessionEmail: session.user?.email,\n                sessionName: session.user?.name,\n                sessionUser: session.user\n            });\n            // 如果 session 中没有 userID，从数据库查找\n            if (!authorUserID && session.user?.email) {\n                // 尝试通过 email 查找用户\n                const dbUser = await users.findOne({\n                    email: session.user.email\n                });\n                console.log(\"Database user lookup:\", {\n                    email: session.user.email,\n                    found: !!dbUser,\n                    hasUserID: dbUser ? !!dbUser.userID : false,\n                    userID: dbUser?.userID,\n                    user: dbUser ? {\n                        userID: dbUser.userID,\n                        name: dbUser.name,\n                        email: dbUser.email,\n                        oauthCompleted: dbUser.oauthCompleted\n                    } : null\n                });\n                if (dbUser) {\n                    if (dbUser.userID) {\n                        authorUserID = dbUser.userID;\n                        console.log(\"Found userID for post creation from database:\", authorUserID);\n                    } else {\n                        // 如果用户存在但没有 userID，尝试通过 accounts 集合查找\n                        console.warn(\"User found but no userID, trying to find via accounts:\", {\n                            email: session.user.email,\n                            userId: dbUser._id.toString(),\n                            name: dbUser.name\n                        });\n                        // 通过 accounts 集合查找关联的用户\n                        const accounts = db.collection(\"accounts\");\n                        const account = await accounts.findOne({\n                            userId: dbUser._id,\n                            provider: {\n                                $in: [\n                                    \"google\",\n                                    \"github\",\n                                    \"facebook\"\n                                ]\n                            }\n                        });\n                        if (account) {\n                            // 如果找到 account，说明用户已经通过 OAuth 登录\n                            // 尝试查找其他有 userID 的用户记录（通过 email）\n                            const userWithUserID = await users.findOne({\n                                email: session.user.email,\n                                userID: {\n                                    $ne: null\n                                }\n                            });\n                            if (userWithUserID && userWithUserID.userID) {\n                                authorUserID = userWithUserID.userID;\n                                console.log(\"Found userID from another user record:\", authorUserID);\n                                // 更新当前用户记录，设置 userID\n                                await users.updateOne({\n                                    _id: dbUser._id\n                                }, {\n                                    $set: {\n                                        userID: authorUserID\n                                    }\n                                });\n                                console.log(\"Updated user record with userID:\", authorUserID);\n                            } else {\n                                // 如果找不到有 userID 的用户记录，生成一个临时的 userID\n                                // 使用 email 的前缀作为 userID\n                                const tempUserID = session.user.email.split(\"@\")[0].toLowerCase().replace(/[^a-z0-9_-]/g, \"_\");\n                                authorUserID = tempUserID;\n                                // 更新用户记录，设置 userID\n                                await users.updateOne({\n                                    _id: dbUser._id\n                                }, {\n                                    $set: {\n                                        userID: authorUserID\n                                    }\n                                });\n                                console.log(\"Generated and set temporary userID:\", authorUserID);\n                            }\n                        } else {\n                            // 如果找不到 account，生成一个临时的 userID\n                            const tempUserID = session.user.email.split(\"@\")[0].toLowerCase().replace(/[^a-z0-9_-]/g, \"_\");\n                            authorUserID = tempUserID;\n                            // 更新用户记录，设置 userID\n                            await users.updateOne({\n                                _id: dbUser._id\n                            }, {\n                                $set: {\n                                    userID: authorUserID\n                                }\n                            });\n                            console.log(\"Generated and set temporary userID (no account):\", authorUserID);\n                        }\n                    }\n                } else {\n                    // 如果通过 email 找不到用户，记录警告\n                    console.warn(\"Cannot find user by email:\", {\n                        email: session.user.email\n                    });\n                }\n            }\n            if (!authorUserID) {\n                console.error(\"Cannot create post: no userID\", {\n                    sessionUser: session.user,\n                    sessionEmail: session.user?.email\n                });\n                return res.status(400).json({\n                    success: false,\n                    message: \"無法識別用戶身份，請重新登入\"\n                });\n            }\n            console.log(\"Creating post with userID:\", authorUserID);\n            const newPost = {\n                content: content.trim(),\n                author: {\n                    userID: authorUserID,\n                    name: session.user.name || \"Unknown\",\n                    email: session.user.email || null,\n                    image: session.user.image || null\n                },\n                likes: [],\n                comments: [],\n                createdAt: new Date()\n            };\n            const result = await posts.insertOne(newPost);\n            const postId = result.insertedId.toString();\n            // 使用 Pusher 推送新貼文（如果配置了 Pusher）\n            try {\n                if (_lib_pusher__WEBPACK_IMPORTED_MODULE_2__.pusherServer) {\n                    await _lib_pusher__WEBPACK_IMPORTED_MODULE_2__.pusherServer.trigger(\"posts\", \"new-post\", {\n                        id: postId,\n                        ...newPost\n                    });\n                }\n            } catch (pusherError) {\n                // Pusher 錯誤不應該阻止貼文創建\n                console.warn(\"Pusher error:\", pusherError);\n            }\n            return res.status(200).json({\n                success: true,\n                post: {\n                    id: postId,\n                    ...newPost\n                }\n            });\n        } catch (error) {\n            console.error(\"Create post error:\", error);\n            return res.status(500).json({\n                success: false,\n                message: \"發文失敗\",\n                error:  true ? error.message : 0\n            });\n        }\n    } else {\n        return res.status(405).json({\n            success: false,\n            message: \"Method not allowed\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T3pDLElBQUlHLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQzFCQyxTQUFTO2dCQUNUQyxTQUFTO2dCQUNUbUMsT0FBT0UsS0FBeUIsR0FBZ0JGLE1BQU1uQyxPQUFPLEdBQUdzQyxDQUFTQTtZQUMzRTtRQUNGO0lBQ0YsT0FBTztRQUNMLE9BQU81QyxJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQzFCQyxTQUFTO1lBQ1RDLFNBQVM7UUFDWDtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly94LWNsb25lLW5leHRqcy8uL3BhZ2VzL2FwaS9wb3N0cy9pbmRleC5qcz84ZTc3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFNlcnZlclNlc3Npb24gfSBmcm9tICduZXh0LWF1dGgvbmV4dCc7XHJcbmltcG9ydCBjbGllbnRQcm9taXNlIGZyb20gJ0AvbGliL21vbmdvZGInO1xyXG5pbXBvcnQgeyBwdXNoZXJTZXJ2ZXIgfSBmcm9tICdAL2xpYi9wdXNoZXInO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xyXG4gIGlmIChyZXEubWV0aG9kID09PSAnR0VUJykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlcnZlclNlc3Npb24ocmVxLCByZXMpO1xyXG4gICAgICBpZiAoIXNlc3Npb24pIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBtZXNzYWdlOiAn5pyq55m75YWlJyxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgeyBmaWx0ZXIgfSA9IHJlcS5xdWVyeTsgLy8gJ2FsbCcgb3IgJ2ZvbGxvd2luZydcclxuICAgICAgY29uc3QgY2xpZW50ID0gYXdhaXQgY2xpZW50UHJvbWlzZTtcclxuICAgICAgY29uc3QgZGIgPSBjbGllbnQuZGIoKTtcclxuICAgICAgY29uc3QgcG9zdHMgPSBkYi5jb2xsZWN0aW9uKCdwb3N0cycpO1xyXG4gICAgICBjb25zdCB1c2VycyA9IGRiLmNvbGxlY3Rpb24oJ3VzZXJzJyk7XHJcblxyXG4gICAgICBsZXQgcXVlcnkgPSB7fTtcclxuXHJcbiAgICAgIC8vIOWmguaenOaYryBmb2xsb3dpbmcg5qih5byP77yM5Y+q6I635Y+WIGZvbGxvdyDnmoTnlKjmiLflj5HluIPnmoTmlofnq6BcclxuICAgICAgaWYgKGZpbHRlciA9PT0gJ2ZvbGxvd2luZycpIHtcclxuICAgICAgICAvLyDojrflj5blvZPliY3nlKjmiLfnmoQgZm9sbG93IOWIl+ihqFxyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gYXdhaXQgdXNlcnMuZmluZE9uZSh7IFxyXG4gICAgICAgICAgJG9yOiBbXHJcbiAgICAgICAgICAgIHsgdXNlcklEOiBzZXNzaW9uLnVzZXI/LnVzZXJJRCB9LFxyXG4gICAgICAgICAgICB7IGVtYWlsOiBzZXNzaW9uLnVzZXI/LmVtYWlsIH1cclxuICAgICAgICAgIF1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgZm9sbG93aW5nTGlzdCA9IGN1cnJlbnRVc2VyPy5mb2xsb3dpbmcgfHwgW107XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGZvbGxvd2luZ0xpc3QubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAvLyDlpoLmnpzmsqHmnIkgZm9sbG93IOS7u+S9leS6uu+8jOi/lOWbnuepuuWIl+ihqFxyXG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgcG9zdHM6IFtdLFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDmn6Xor6IgZm9sbG93IOeahOeUqOaIt+WPkeW4g+eahOaWh+eroFxyXG4gICAgICAgIHF1ZXJ5ID0ge1xyXG4gICAgICAgICAgJ2F1dGhvci51c2VySUQnOiB7ICRpbjogZm9sbG93aW5nTGlzdCB9XHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgYWxsUG9zdHMgPSBhd2FpdCBwb3N0c1xyXG4gICAgICAgIC5maW5kKHF1ZXJ5KVxyXG4gICAgICAgIC5zb3J0KHsgY3JlYXRlZEF0OiAtMSB9KVxyXG4gICAgICAgIC5saW1pdCg1MClcclxuICAgICAgICAudG9BcnJheSgpO1xyXG5cclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIHBvc3RzOiBhbGxQb3N0cy5tYXAoKHBvc3QpID0+ICh7XHJcbiAgICAgICAgICBpZDogcG9zdC5faWQudG9TdHJpbmcoKSxcclxuICAgICAgICAgIGNvbnRlbnQ6IHBvc3QuY29udGVudCxcclxuICAgICAgICAgIGF1dGhvcjogcG9zdC5hdXRob3IsXHJcbiAgICAgICAgICBsaWtlczogcG9zdC5saWtlcyB8fCBbXSxcclxuICAgICAgICAgIGNvbW1lbnRzOiBwb3N0LmNvbW1lbnRzIHx8IFtdLFxyXG4gICAgICAgICAgcmVwb3N0Q291bnQ6IHBvc3QucmVwb3N0Q291bnQgfHwgMCxcclxuICAgICAgICAgIHJlcG9zdDogcG9zdC5yZXBvc3QgfHwgbnVsbCxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogcG9zdC5jcmVhdGVkQXQsXHJcbiAgICAgICAgfSkpLFxyXG4gICAgICB9KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0dldCBwb3N0cyBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogJ+eNsuWPluiyvOaWh+WkseaVlycsXHJcbiAgICAgICAgZXJyb3I6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyb3IubWVzc2FnZSA6IHVuZGVmaW5lZCxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSBlbHNlIGlmIChyZXEubWV0aG9kID09PSAnUE9TVCcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXJ2ZXJTZXNzaW9uKHJlcSwgcmVzKTtcclxuICAgICAgaWYgKCFzZXNzaW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgbWVzc2FnZTogJ+acqueZu+WFpScsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHsgY29udGVudCB9ID0gcmVxLmJvZHk7XHJcblxyXG4gICAgICBpZiAoIWNvbnRlbnQgfHwgY29udGVudC50cmltKCkgPT09ICcnKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgbWVzc2FnZTogJ+iyvOaWh+WFp+WuueS4jeiDveeCuuepuicsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IGNsaWVudFByb21pc2U7XHJcbiAgICAgIGNvbnN0IGRiID0gY2xpZW50LmRiKCk7XHJcbiAgICAgIGNvbnN0IHBvc3RzID0gZGIuY29sbGVjdGlvbigncG9zdHMnKTtcclxuICAgICAgY29uc3QgdXNlcnMgPSBkYi5jb2xsZWN0aW9uKCd1c2VycycpO1xyXG5cclxuICAgICAgLy8g56Gu5L+dIHVzZXJJRCDlrZjlnKhcclxuICAgICAgbGV0IGF1dGhvclVzZXJJRCA9IHNlc3Npb24udXNlcj8udXNlcklEO1xyXG4gICAgICBcclxuICAgICAgLy8g6LCD6K+V5pel5b+XXHJcbiAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGluZyBwb3N0IC0gc2Vzc2lvbiBjaGVjazonLCB7XHJcbiAgICAgICAgc2Vzc2lvblVzZXJJRDogc2Vzc2lvbi51c2VyPy51c2VySUQsXHJcbiAgICAgICAgc2Vzc2lvbkVtYWlsOiBzZXNzaW9uLnVzZXI/LmVtYWlsLFxyXG4gICAgICAgIHNlc3Npb25OYW1lOiBzZXNzaW9uLnVzZXI/Lm5hbWUsXHJcbiAgICAgICAgc2Vzc2lvblVzZXI6IHNlc3Npb24udXNlcixcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyDlpoLmnpwgc2Vzc2lvbiDkuK3msqHmnIkgdXNlcklE77yM5LuO5pWw5o2u5bqT5p+l5om+XHJcbiAgICAgIGlmICghYXV0aG9yVXNlcklEICYmIHNlc3Npb24udXNlcj8uZW1haWwpIHtcclxuICAgICAgICAvLyDlsJ3or5XpgJrov4cgZW1haWwg5p+l5om+55So5oi3XHJcbiAgICAgICAgY29uc3QgZGJVc2VyID0gYXdhaXQgdXNlcnMuZmluZE9uZSh7IGVtYWlsOiBzZXNzaW9uLnVzZXIuZW1haWwgfSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFiYXNlIHVzZXIgbG9va3VwOicsIHtcclxuICAgICAgICAgIGVtYWlsOiBzZXNzaW9uLnVzZXIuZW1haWwsXHJcbiAgICAgICAgICBmb3VuZDogISFkYlVzZXIsXHJcbiAgICAgICAgICBoYXNVc2VySUQ6IGRiVXNlciA/ICEhZGJVc2VyLnVzZXJJRCA6IGZhbHNlLFxyXG4gICAgICAgICAgdXNlcklEOiBkYlVzZXI/LnVzZXJJRCxcclxuICAgICAgICAgIHVzZXI6IGRiVXNlciA/IHtcclxuICAgICAgICAgICAgdXNlcklEOiBkYlVzZXIudXNlcklELFxyXG4gICAgICAgICAgICBuYW1lOiBkYlVzZXIubmFtZSxcclxuICAgICAgICAgICAgZW1haWw6IGRiVXNlci5lbWFpbCxcclxuICAgICAgICAgICAgb2F1dGhDb21wbGV0ZWQ6IGRiVXNlci5vYXV0aENvbXBsZXRlZCxcclxuICAgICAgICAgIH0gOiBudWxsLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChkYlVzZXIpIHtcclxuICAgICAgICAgIGlmIChkYlVzZXIudXNlcklEKSB7XHJcbiAgICAgICAgICAgIGF1dGhvclVzZXJJRCA9IGRiVXNlci51c2VySUQ7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGb3VuZCB1c2VySUQgZm9yIHBvc3QgY3JlYXRpb24gZnJvbSBkYXRhYmFzZTonLCBhdXRob3JVc2VySUQpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8g5aaC5p6c55So5oi35a2Y5Zyo5L2G5rKh5pyJIHVzZXJJRO+8jOWwneivlemAmui/hyBhY2NvdW50cyDpm4blkIjmn6Xmib5cclxuICAgICAgICAgICAgY29uc29sZS53YXJuKCdVc2VyIGZvdW5kIGJ1dCBubyB1c2VySUQsIHRyeWluZyB0byBmaW5kIHZpYSBhY2NvdW50czonLCB7XHJcbiAgICAgICAgICAgICAgZW1haWw6IHNlc3Npb24udXNlci5lbWFpbCxcclxuICAgICAgICAgICAgICB1c2VySWQ6IGRiVXNlci5faWQudG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICBuYW1lOiBkYlVzZXIubmFtZSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDpgJrov4cgYWNjb3VudHMg6ZuG5ZCI5p+l5om+5YWz6IGU55qE55So5oi3XHJcbiAgICAgICAgICAgIGNvbnN0IGFjY291bnRzID0gZGIuY29sbGVjdGlvbignYWNjb3VudHMnKTtcclxuICAgICAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGFjY291bnRzLmZpbmRPbmUoeyBcclxuICAgICAgICAgICAgICB1c2VySWQ6IGRiVXNlci5faWQsXHJcbiAgICAgICAgICAgICAgcHJvdmlkZXI6IHsgJGluOiBbJ2dvb2dsZScsICdnaXRodWInLCAnZmFjZWJvb2snXSB9LFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChhY2NvdW50KSB7XHJcbiAgICAgICAgICAgICAgLy8g5aaC5p6c5om+5YiwIGFjY291bnTvvIzor7TmmI7nlKjmiLflt7Lnu4/pgJrov4cgT0F1dGgg55m75b2VXHJcbiAgICAgICAgICAgICAgLy8g5bCd6K+V5p+l5om+5YW25LuW5pyJIHVzZXJJRCDnmoTnlKjmiLforrDlvZXvvIjpgJrov4cgZW1haWzvvIlcclxuICAgICAgICAgICAgICBjb25zdCB1c2VyV2l0aFVzZXJJRCA9IGF3YWl0IHVzZXJzLmZpbmRPbmUoe1xyXG4gICAgICAgICAgICAgICAgZW1haWw6IHNlc3Npb24udXNlci5lbWFpbCxcclxuICAgICAgICAgICAgICAgIHVzZXJJRDogeyAkbmU6IG51bGwgfSxcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICBpZiAodXNlcldpdGhVc2VySUQgJiYgdXNlcldpdGhVc2VySUQudXNlcklEKSB7XHJcbiAgICAgICAgICAgICAgICBhdXRob3JVc2VySUQgPSB1c2VyV2l0aFVzZXJJRC51c2VySUQ7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRm91bmQgdXNlcklEIGZyb20gYW5vdGhlciB1c2VyIHJlY29yZDonLCBhdXRob3JVc2VySUQpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyDmm7TmlrDlvZPliY3nlKjmiLforrDlvZXvvIzorr7nva4gdXNlcklEXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB1c2Vycy51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgIHsgX2lkOiBkYlVzZXIuX2lkIH0sXHJcbiAgICAgICAgICAgICAgICAgIHsgJHNldDogeyB1c2VySUQ6IGF1dGhvclVzZXJJRCB9IH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXBkYXRlZCB1c2VyIHJlY29yZCB3aXRoIHVzZXJJRDonLCBhdXRob3JVc2VySUQpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlpoLmnpzmib7kuI3liLDmnIkgdXNlcklEIOeahOeUqOaIt+iusOW9le+8jOeUn+aIkOS4gOS4quS4tOaXtueahCB1c2VySURcclxuICAgICAgICAgICAgICAgIC8vIOS9v+eUqCBlbWFpbCDnmoTliY3nvIDkvZzkuLogdXNlcklEXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZW1wVXNlcklEID0gc2Vzc2lvbi51c2VyLmVtYWlsLnNwbGl0KCdAJylbMF0udG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtejAtOV8tXS9nLCAnXycpO1xyXG4gICAgICAgICAgICAgICAgYXV0aG9yVXNlcklEID0gdGVtcFVzZXJJRDtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8g5pu05paw55So5oi36K6w5b2V77yM6K6+572uIHVzZXJJRFxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdXNlcnMudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICB7IF9pZDogZGJVc2VyLl9pZCB9LFxyXG4gICAgICAgICAgICAgICAgICB7ICRzZXQ6IHsgdXNlcklEOiBhdXRob3JVc2VySUQgfSB9XHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0dlbmVyYXRlZCBhbmQgc2V0IHRlbXBvcmFyeSB1c2VySUQ6JywgYXV0aG9yVXNlcklEKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgLy8g5aaC5p6c5om+5LiN5YiwIGFjY291bnTvvIznlJ/miJDkuIDkuKrkuLTml7bnmoQgdXNlcklEXHJcbiAgICAgICAgICAgICAgY29uc3QgdGVtcFVzZXJJRCA9IHNlc3Npb24udXNlci5lbWFpbC5zcGxpdCgnQCcpWzBdLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW15hLXowLTlfLV0vZywgJ18nKTtcclxuICAgICAgICAgICAgICBhdXRob3JVc2VySUQgPSB0ZW1wVXNlcklEO1xyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgIC8vIOabtOaWsOeUqOaIt+iusOW9le+8jOiuvue9riB1c2VySURcclxuICAgICAgICAgICAgICBhd2FpdCB1c2Vycy51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICB7IF9pZDogZGJVc2VyLl9pZCB9LFxyXG4gICAgICAgICAgICAgICAgeyAkc2V0OiB7IHVzZXJJRDogYXV0aG9yVXNlcklEIH0gfVxyXG4gICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0dlbmVyYXRlZCBhbmQgc2V0IHRlbXBvcmFyeSB1c2VySUQgKG5vIGFjY291bnQpOicsIGF1dGhvclVzZXJJRCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8g5aaC5p6c6YCa6L+HIGVtYWlsIOaJvuS4jeWIsOeUqOaIt++8jOiusOW9leitpuWRilxyXG4gICAgICAgICAgY29uc29sZS53YXJuKCdDYW5ub3QgZmluZCB1c2VyIGJ5IGVtYWlsOicsIHtcclxuICAgICAgICAgICAgZW1haWw6IHNlc3Npb24udXNlci5lbWFpbCxcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCFhdXRob3JVc2VySUQpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdDYW5ub3QgY3JlYXRlIHBvc3Q6IG5vIHVzZXJJRCcsIHtcclxuICAgICAgICAgIHNlc3Npb25Vc2VyOiBzZXNzaW9uLnVzZXIsXHJcbiAgICAgICAgICBzZXNzaW9uRW1haWw6IHNlc3Npb24udXNlcj8uZW1haWwsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgbWVzc2FnZTogJ+eEoeazleitmOWIpeeUqOaItui6q+S7ve+8jOiri+mHjeaWsOeZu+WFpScsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGluZyBwb3N0IHdpdGggdXNlcklEOicsIGF1dGhvclVzZXJJRCk7XHJcblxyXG4gICAgICBjb25zdCBuZXdQb3N0ID0ge1xyXG4gICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQudHJpbSgpLFxyXG4gICAgICAgIGF1dGhvcjoge1xyXG4gICAgICAgICAgdXNlcklEOiBhdXRob3JVc2VySUQsXHJcbiAgICAgICAgICBuYW1lOiBzZXNzaW9uLnVzZXIubmFtZSB8fCAnVW5rbm93bicsXHJcbiAgICAgICAgICBlbWFpbDogc2Vzc2lvbi51c2VyLmVtYWlsIHx8IG51bGwsXHJcbiAgICAgICAgICBpbWFnZTogc2Vzc2lvbi51c2VyLmltYWdlIHx8IG51bGwsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBsaWtlczogW10sXHJcbiAgICAgICAgY29tbWVudHM6IFtdLFxyXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBvc3RzLmluc2VydE9uZShuZXdQb3N0KTtcclxuICAgICAgY29uc3QgcG9zdElkID0gcmVzdWx0Lmluc2VydGVkSWQudG9TdHJpbmcoKTtcclxuXHJcbiAgICAgIC8vIOS9v+eUqCBQdXNoZXIg5o6o6YCB5paw6LK85paH77yI5aaC5p6c6YWN572u5LqGIFB1c2hlcu+8iVxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGlmIChwdXNoZXJTZXJ2ZXIpIHtcclxuICAgICAgICAgIGF3YWl0IHB1c2hlclNlcnZlci50cmlnZ2VyKCdwb3N0cycsICduZXctcG9zdCcsIHtcclxuICAgICAgICAgICAgaWQ6IHBvc3RJZCxcclxuICAgICAgICAgICAgLi4ubmV3UG9zdCxcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAocHVzaGVyRXJyb3IpIHtcclxuICAgICAgICAvLyBQdXNoZXIg6Yyv6Kqk5LiN5oeJ6Kmy6Zi75q2i6LK85paH5Ym15bu6XHJcbiAgICAgICAgY29uc29sZS53YXJuKCdQdXNoZXIgZXJyb3I6JywgcHVzaGVyRXJyb3IpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgcG9zdDoge1xyXG4gICAgICAgICAgaWQ6IHBvc3RJZCxcclxuICAgICAgICAgIC4uLm5ld1Bvc3QsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdDcmVhdGUgcG9zdCBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogJ+eZvOaWh+WkseaVlycsXHJcbiAgICAgICAgZXJyb3I6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyb3IubWVzc2FnZSA6IHVuZGVmaW5lZCxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBtZXNzYWdlOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyxcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuIl0sIm5hbWVzIjpbImdldFNlcnZlclNlc3Npb24iLCJjbGllbnRQcm9taXNlIiwicHVzaGVyU2VydmVyIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInNlc3Npb24iLCJzdGF0dXMiLCJqc29uIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJmaWx0ZXIiLCJxdWVyeSIsImNsaWVudCIsImRiIiwicG9zdHMiLCJjb2xsZWN0aW9uIiwidXNlcnMiLCJjdXJyZW50VXNlciIsImZpbmRPbmUiLCIkb3IiLCJ1c2VySUQiLCJ1c2VyIiwiZW1haWwiLCJmb2xsb3dpbmdMaXN0IiwiZm9sbG93aW5nIiwibGVuZ3RoIiwiJGluIiwiYWxsUG9zdHMiLCJmaW5kIiwic29ydCIsImNyZWF0ZWRBdCIsImxpbWl0IiwidG9BcnJheSIsIm1hcCIsInBvc3QiLCJpZCIsIl9pZCIsInRvU3RyaW5nIiwiY29udGVudCIsImF1dGhvciIsImxpa2VzIiwiY29tbWVudHMiLCJyZXBvc3RDb3VudCIsInJlcG9zdCIsImVycm9yIiwiY29uc29sZSIsInByb2Nlc3MiLCJ1bmRlZmluZWQiLCJib2R5IiwidHJpbSIsImF1dGhvclVzZXJJRCIsImxvZyIsInNlc3Npb25Vc2VySUQiLCJzZXNzaW9uRW1haWwiLCJzZXNzaW9uTmFtZSIsIm5hbWUiLCJzZXNzaW9uVXNlciIsImRiVXNlciIsImZvdW5kIiwiaGFzVXNlcklEIiwib2F1dGhDb21wbGV0ZWQiLCJ3YXJuIiwidXNlcklkIiwiYWNjb3VudHMiLCJhY2NvdW50IiwicHJvdmlkZXIiLCJ1c2VyV2l0aFVzZXJJRCIsIiRuZSIsInVwZGF0ZU9uZSIsIiRzZXQiLCJ0ZW1wVXNlcklEIiwic3BsaXQiLCJ0b0xvd2VyQ2FzZSIsInJlcGxhY2UiLCJuZXdQb3N0IiwiaW1hZ2UiLCJEYXRlIiwicmVzdWx0IiwiaW5zZXJ0T25lIiwicG9zdElkIiwiaW5zZXJ0ZWRJZCIsInRyaWdnZXIiLCJwdXNoZXJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/posts/index.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fposts&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cposts%5Cindex.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();